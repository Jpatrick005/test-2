1. Use the dataset mpg

a. Show your solutions on how to import a csv file into the environment.
```{r}
mpgdata <- read.csv("mpg.csv")
mpgdata
```
b. Which variables from mpg dataset are categorical?

manufacturer - The car manufacturer (e.g., Audi, Chevrolet).
 - model
 - trans
 - drv
 - cyl
 - fl
 - class
 - manufacturer
  

c. Which are continuous variables?
 - displ
 - year
 - cyt
 - hwy
 
 
2. Which manufacturer has the most models in this data set? Which model has the most variations? Show your answer.
```{r}
manufacturer_count <- mpgdata %>%
  group_by(manufacturer) %>%
  summarise(model_count = n_distinct(model)) %>%
  arrange(desc(model_count))

most_models_manufacturer <- manufacturer_count[1, ]

model_variation_count <- mpgdata %>%
  group_by(model) %>%
  summarise(variation_count = n()) %>%
  arrange(desc(variation_count))

most_variations_model <- model_variation_count[1, ]

most_models_manufacturer
most_variations_model
```
a. Group the manufacturers and find the unique models. Show your codes and result.
```{r}
unique_models <- mpgdata %>%
  group_by(manufacturer) %>%
  summarise(unique_models = list(unique(model))) %>%
  arrange(manufacturer)

print(unique_models)
```
b. Graph the result by using plot() and ggplot(). Write the codes and its result.
```{r}
model_counts <- mpgdata %>%
  group_by(manufacturer) %>%
  summarise(unique_model_count = n_distinct(model)) %>%
  arrange(desc(unique_model_count))


barplot(model_counts$unique_model_count, 
        names.arg = model_counts$manufacturer, 
        las = 2, 
        col = "lightblue", 
        main = "Number of Unique Models by Manufacturer",
        xlab = "Manufacturer", 
        ylab = "Number of Unique Models")


library(ggplot2)

ggplot(model_counts, aes(x = reorder(manufacturer, unique_model_count), y = unique_model_count)) +
  geom_bar(stat = "identity", fill = "lightblue") +
  coord_flip() +
  labs(title = "Number of Unique Models by Manufacturer", 
       x = "Manufacturer", 
       y = "Number of Unique Models") +
  theme_minimal()

```
2. Same dataset will be used. You are going to show the relationship of the modeland the manufacturer.

a. What does ggplot(mpg, aes(model, manufacturer)) + geom_point() show?
This code generates a scatter plot using ggplot2, where:

x-axis: represents the model.
y-axis: represents the manufacturer.
However, since both model and manufacturer are categorical variables, the plot will display points for each combination of model and manufacturer. This can lead to a large number of overlapping points, making it difficult to discern any meaningful relationships or patterns.

The result will likely look cluttered and may not effectively convey the relationship between the two variables.

b. For you, is it useful? If not, how could you modify the data to make it more informative?
Usefulness:

In its current form, the plot is not very useful for understanding the relationship between model and manufacturer due to the overplotting of points and the lack of numerical or continuous variables that might provide more insights.



3. Plot the model and the year using ggplot(). Use only the top 20 observations. Write the codes and its results.
```{r}
library(ggplot2)
library(dplyr)
top_20_mpg <- mpgdata %>%
  arrange(desc(cty)) %>%
  head(20)
ggplot(top_20_mpg, aes(x = model, y = year)) +
  geom_point() +
  labs(title = "Top 20 Models by Year", x = "Model", y = "Year") +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

```
4. Using the pipe (%>%), group the model and get the number of cars per model. Show codes and its result
```{r}
model_counts <- mpg %>%
  group_by(model) %>%
  summarise(number_of_cars = n()) %>%
  arrange(desc(number_of_cars))

print(model_counts)

```
a. Plot using geom_bar() using the top 20 observations only. The graphs should have a title, labels and colors. Show code and results.
```{r}
top_models <- mpgdata %>%
  group_by(model) %>%
  summarise(number_of_cars = n()) %>%
  arrange(desc(number_of_cars)) %>%
  slice_head(n = 20)

ggplot(top_models, aes(x = reorder(model, number_of_cars), y = number_of_cars, fill = model)) +
  geom_bar(stat = "identity") +
  coord_flip() +  
  labs(title = "Top 20 Car Models by Number of Cars",
       x = "Car Model",
       y = "Number of Cars",
       fill = "Model") +
  theme_minimal() +
  scale_fill_viridis_d() 
```
b. Plot using the geom_bar() + coord_flip() just like what is shown below. Show codes and its result.
```{r}
library(viridis)
library(viridisLite)
top_models <- mpgdata %>%
  group_by(model) %>%
  summarise(number_of_cars = n()) %>%
  arrange(desc(number_of_cars)) %>%
  slice_head(n = 20)

ggplot(top_models, aes(x = reorder(model, number_of_cars), y = number_of_cars, fill = model)) +
  geom_bar(stat = "identity") +
  coord_flip() +
  labs(title = "Top 20 Car Models by Number of Cars",
       x = "Car Model",
       y = "Number of Cars") +
  theme_minimal() +
  scale_fill_viridis_d()
```

```{r}

```


